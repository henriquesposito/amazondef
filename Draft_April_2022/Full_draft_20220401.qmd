---
title: "How has the Brazilian Amazon been constructed as a problem? An analysis of presidential speeches since 1985"
format:
  docx:
    toc: false
    reference-doc: "template.docx"
    section-numbers: true
    highlight-style: github
abstract: This paper ...
output: docx
author:
- Livio Silva-Muller^[Phd Candidate, The Graduate Institute Geneva, livio.silva@graduateinstitute.ch]
- Henrique Sposito^[Phd Candidate, The Graduate Institute Geneva, henrique.sposito@graduateinstitute.ch]

date: "April 2022"

---
```{r setup, include=FALSE, warning=FALSE, message=FALSE}

knitr::opts_chunk$set(include = FALSE)
library(tidyverse)
library(tidyr)
library(skimr)
library(scales)
library(RColorBrewer)
library(kableExtra)
library(nnet)

Sys.setlocale("LC_ALL", "C")

options(stringsAsFactors = FALSE, scipen = 999)

```

```{r data, message=FALSE, warning=FALSE, include=FALSE}

pop<- readRDS("~/Documents/GitHub/amazondef/BR_presid_speeches_final.Rds")
ama <- readRDS("~/Documents/GitHub/amazondef/final_data_as.Rds")

ama <-  ama %>%
          select(-c(title, date, text, false_positives)) %>%
          rename (ei= "EI") %>%
          rename (sd= "SD")

pop <-  pop %>%
          select(-c(title, date, text, location))

```

```{r data prep for prob_construction, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

sov <- ama %>% 
  filter(sov==1) %>% 
  count(sov, year) %>%
  group_by(year) %>%
  select(-c(sov))%>%
  rename (sov = n)

ei <- ama %>% 
  filter(ei==1) %>% 
  count(ei, year) %>%
  group_by(year) %>%
  select(-c(ei))%>%
  rename (ei = n) %>%
  ungroup() %>%
  tibble::add_row(year = 2017, ei = 0) %>%
  tibble::add_row(year = 2018, ei = 0)

sd <- ama %>% 
  filter(sd==1) %>% 
  count(sd, year) %>%
  group_by(year) %>%
  select(-c(sd))%>%
  rename (sd = n)

con <- ama %>% 
  filter(con==1) %>% 
  count(con, year) %>%
  group_by(year) %>%
  select(-c(con))%>%
  rename (con = n)

other <- ama %>% 
  filter(other==1) %>% 
  count(other, year) %>%
  group_by(year) %>%
  select(-c(other))%>%
  rename (other = n)

temp <- ei %>% left_join(other) %>% 
                left_join(con) %>%
                left_join(sd) %>%
                left_join(sov) %>%
                replace(is.na(.), 0)

```

```{r data prep for mixed_types, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

ama_mx <- ama %>% 
  unite(mixed_type, sov:con, sep="_") %>%
  mutate(mx_cat= case_when (mixed_type=='1_0_0_0' ~ "Pure Sovereignty",
                            mixed_type=='0_1_0_0' ~ "Pure Economic Integration",
                            mixed_type=='0_0_1_0' ~ "Pure Social Development",
                            mixed_type=='0_0_0_1' ~ "Pure Conservation",
                            mixed_type=='0_0_0_0' ~"Other",
                            mixed_type=='0_1_0_1' ~"Economic Conservation",
                            mixed_type=='0_1_1_0' ~"Economic and Social Development",
                            mixed_type=='1_0_0_1' ~"Sovereign Conservation",
                            mixed_type=='0_1_1_1' ~ "Sustainable Development",
                            mixed_type=='1_1_0_0'~ "Sovereign Integration",
                            mixed_type=='0_0_1_1' ~"Social Conservation",
                            mixed_type=='1_1_0_1' ~"Other Mixed-types",
                            mixed_type=='1_0_1_0' ~"Other Mixed-types",
                            mixed_type=='1_0_1_0' ~"Other Mixed-types",
                            mixed_type=='1_1_1_1' ~"Other Mixed-types",
                            mixed_type=='1_1_1_0' ~"Other Mixed-types",
                            mixed_type=='1_0_1_1' ~"Other Mixed-types"))%>%
  mutate(mx_cat=factor(mx_cat, levels = c("Pure Economic Integration", "Pure Conservation", "Pure Social Development", "Pure Sovereignty", "Other", "Economic Conservation", "Economic and Social Development", "Sovereign Conservation","Sustainable Development","Sovereign Integration", "Social Conservation", "Other Mixed-types"))) %>%
mutate(mx_cat2= case_when (mixed_type=='1_0_0_0' ~ "Pure-type",
                            mixed_type=='0_1_0_0' ~ "Pure-type",
                            mixed_type=='0_0_1_0' ~ "Pure-type",
                            mixed_type=='0_0_0_1' ~ "Pure-type",
                            mixed_type=='0_0_0_0' ~"Other",
                            mixed_type=='0_1_0_1' ~"Mixed-type",
                            mixed_type=='0_1_1_0' ~"Mixed-type",
                            mixed_type=='1_0_0_1' ~"Mixed-type",
                            mixed_type=='0_1_1_1' ~ "Mixed-type",
                            mixed_type=='1_1_0_0'~ "Mixed-type",
                            mixed_type=='0_0_1_1' ~"Mixed-type",
                            mixed_type=='1_1_0_1' ~"Mixed-type",
                            mixed_type=='1_0_1_0' ~"Mixed-type",
                            mixed_type=='1_0_1_0' ~"Mixed-type",
                            mixed_type=='1_1_1_1' ~"Mixed-type",
                            mixed_type=='1_1_1_0' ~"Mixed-type",
                            mixed_type=='1_0_1_1' ~"Mixed-type"))


```

# 1 Introduction

# 2  Amazonian policy-cycles, discourse, and problem-construction
## 2.1 Literature Review: policy-cycles in the Amazonian literature

### 2.1.1 National sovereignty

### 2.1.2 Economic integration

### 2.1.3 Environmental conservation

### 2.1.4 Policy and discourse

## 2.2 Theoretical framework: problem-construction and presidential discourse

# 3 Research Design

## 3.1 Data and modeling: operationalizing Amazonian problem construction

## 3.2 Analysis and limitations

# 4 How has the amazon been constructed as a problem?

## 4.1 The rises and falls of the Amazon as a topic in presidential speeches

```{r Amazonian speeches by year, echo=FALSE, message=FALSE, warning=TRUE, echo=FALSE, paged.print=TRUE}

perc1 <- pop %>%
  count(amazon_speech, year)%>%
  group_by(year)%>%
  mutate(perc=n / sum(n)) %>%
  select(c(perc,amazon_speech, year))

pop %>% count(amazon_speech, year) %>%
  group_by(year) %>%
  left_join(perc1) %>%
  filter(amazon_speech==1) %>%
  ggplot(., aes(x = year, y = perc)) +
  geom_line(color="darkolivegreen")+
  scale_y_continuous(labels = percent_format())+
  scale_fill_brewer(type = "qual", palette = "Set2", direction= -1)+
  labs(
    x = "", y = "", title ="Share of speeches mentioning the Amazon by year",
    subtitle = "Sample composed by 6130 presidential speeches since 1985",
    caption = "") +
  theme(
    panel.background = element_rect("white", "black", .5, "solid"),
    panel.grid.major = element_line(color = "grey", size = 0.3, linetype = "solid"),
    axis.text = element_text(color = "black", size = 10),
    title = element_text(color = "black", size = 10, face = "bold"),
    legend.title = element_blank(),
    plot.subtitle = element_text(color = "black", size = 9, face = "plain"),
    legend.position = "right"
  )

```

## 4.2 Amazonian problem-construction in time

```{r mixed-types in time, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

ama_mx %>%
  count(year, mx_cat)%>%
  group_by(year) %>%
  mutate(perc=n / sum(n))  %>%
  ggplot(., aes(x=year, y=perc, fill=mx_cat))+
  geom_bar(stat="identity", position="dodge")+
  geom_smooth(color="black", size=.3, se= FALSE)+
  scale_y_continuous(labels = percent_format(accuracy=1))+
  labs(
    x = "", y = "", title ="Share of different problem-constructions by year",
    subtitle = "Sample composed by 2400 problem-constructions in 1885 Amazonian statements in presidential speeches since 1985",
    caption = "") +
  theme(
    panel.background = element_rect("white", "black", .5, "solid"),
    panel.grid.major = element_line(color = "grey", size = 0.3, linetype = "solid"),
    axis.text = element_text(color = "black", size = 10),
    title = element_text(color = "black", size = 10, face = "bold"),
    legend.title = element_blank(),
    plot.subtitle = element_text(color = "black", size = 9, face = "plain"),
    legend.position = "none"
  )+
  facet_wrap(~ mx_cat, ncol=3, scales="free_y")
    
```

```{r pure types in time , echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

ama_mx %>%
  count(president, mx_cat, mx_cat2)%>%
  group_by(president) %>%
  mutate(perc=n / sum(n)) %>%
  filter(mx_cat !="Other")%>%
  filter(mx_cat2 == "Pure-type") %>%
  mutate(year= case_when (president=='Sarney' ~ "1985",
                          president=='Bolsonaro' ~ "2018",
                          president=='Collor' ~ "1990",
                          president=='Itamar' ~ "1993",
                          president=='FHC' ~ "1994",
                          president=='Lula' ~ "2003",
                          president=='Dilma' ~ "2011",
                          president=='Temer' ~ "2017"))%>%
  ggplot(., aes(x=as.numeric(year), y=perc, color=mx_cat))+
  geom_smooth(aes(color=mx_cat), se=FALSE, size=.5)+
  scale_y_continuous(labels = percent_format(accuracy=1))+
  labs(
    x = "", y = "", title ="Share of each pure types by year",
    subtitle = "Sample composed by 1885 Amazonian statements in presidential speeches since 1985",
    caption = "") +
  theme(
    panel.background = element_rect("white", "black", .5, "solid"),
    panel.grid.major = element_line(color = "grey", size = 0.3, linetype = "solid"),
    axis.text = element_text(color = "black", size = 10),
    title = element_text(color = "black", size = 10, face = "bold"),
    legend.title = element_blank(),
    plot.subtitle = element_text(color = "black", size = 9, face = "plain"),
    legend.position = "bottom"
  )

```

```{r mixed-types by president , echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

ama_mx %>%
  filter(mx_cat2 =="Mixed-type")%>%
  count(president, mx_cat)%>%
  group_by(president) %>%
  mutate(perc=n / sum(n)) %>%
  mutate(president=factor(president, levels = c("Sarney", "Collor", "Itamar", "FHC", "Lula", "Dilma", "Temer", "Bolsonaro"))) %>%
  ggplot(., aes(x=president, y=perc, fill=mx_cat,label= scales::percent(perc, accuracy=.1)))+
  geom_bar(stat="identity", position="stack")+
  geom_text(size = 3, position = position_stack(vjust=.5))+
  scale_fill_brewer(type = "qual", palette = "Set2", direction= 1)+
  labs(
    x = "", y = "", title ="Share of each mixed type problem-constructions by president",
    subtitle = "Sample composed of Amazonian statements that were coded as a mixed-type (n=431)",
    caption = "") +
  theme(
    panel.background = element_rect("white", "black", .5, "solid"),
    panel.grid.major = element_line(color = "grey", size = 0.3, linetype = "solid"),
    axis.text = element_text(color = "black", size = 10),
    title = element_text(color = "black", size = 10, face = "bold"),
    legend.title = element_blank(),
    plot.subtitle = element_text(color = "black", size = 9, face = "plain"),
    legend.position = "bottom"
  )
```


## 4.3 An Amazonian three-level game? Boasting policy outside, talking to people inside

# 5 Conclusion

# 6 References


